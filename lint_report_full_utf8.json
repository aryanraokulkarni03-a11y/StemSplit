[{"filePath":"C:\\Users\\HP\\Documents\\AI\\Singscape\\frontend\\src\\app\\api\\health\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\Documents\\AI\\Singscape\\frontend\\src\\app\\api\\separate\\[jobId]\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\Documents\\AI\\Singscape\\frontend\\src\\app\\api\\separate\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'StemStatus' is defined but never used.","line":17,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":21}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from 'next/server';\r\nimport { spawn } from 'child_process';\r\nimport path from 'path';\r\n\r\nexport const runtime = 'nodejs';\r\n\r\n// Stem types available for separation\r\nconst STEM_TYPES = ['vocals', 'no_vocals'] as const;\r\ntype StemType = typeof STEM_TYPES[number];\r\n\r\ninterface SeparationRequest {\r\n    fileId?: string;\r\n    fileName: string;\r\n    stems?: StemType[];\r\n}\r\n\r\ninterface StemStatus {\r\n    name: StemType;\r\n    status: 'pending' | 'processing' | 'complete' | 'error';\r\n    progress: number;\r\n}\r\n\r\n// POST /api/separate - Initiate REAL stem separation using Demucs\r\nexport async function POST(request: NextRequest) {\r\n    try {\r\n        const body = await request.json() as SeparationRequest;\r\n\r\n        if (!body.fileName) {\r\n            return NextResponse.json({ error: 'fileName is required' }, { status: 400 });\r\n        }\r\n\r\n        // Generate job ID and paths\r\n        const jobId = `job_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\r\n        const outputDir = path.join(process.cwd(), 'public', 'separated', jobId);\r\n\r\n        // Input file path (Assumes file was uploaded to public/uploads)\r\n        // TODO: In Phase 2.1, ensure upload endpoint saves here or use absolute path from upload response\r\n        const inputFilePath = path.join(process.cwd(), 'public', 'uploads', body.fileName);\r\n\r\n        console.log(`[API] Starting Demucs job ${jobId} for file ${inputFilePath}`);\r\n\r\n        // Spawn Python process DETACHED so it survives the request\r\n        // process.cwd() is likely '.../frontend', so we go up one level to find 'backend'\r\n        const pythonScript = path.join(process.cwd(), '..', 'backend', 'python', 'worker.py');\r\n\r\n        // We use 'python' assuming it's in PATH. If using venv, might need absolute path to venv/Scripts/python\r\n        const pythonProcess = spawn('python', [\r\n            pythonScript,\r\n            '--input', inputFilePath,\r\n            '--out', outputDir\r\n        ], {\r\n            detached: true,\r\n            stdio: 'ignore' // Ignore stdio to allow unref\r\n        });\r\n\r\n        // Unreference the child process so the parent node process can exit independently\r\n        // This is critical for Vercel/Next.js to not hold the request open\r\n        pythonProcess.unref();\r\n\r\n        return NextResponse.json({\r\n            success: true,\r\n            jobId,\r\n            statusEndpoint: `/api/separate/${jobId}`,\r\n            message: 'Separation job started in background.',\r\n        });\r\n\r\n    } catch (error) {\r\n        console.error('Separation error:', error);\r\n        return NextResponse.json({ error: 'Failed to initiate separation' }, { status: 500 });\r\n    }\r\n}\r\n\r\n// GET /api/separate - Return API documentation\r\nexport async function GET() {\r\n    return NextResponse.json({\r\n        description: 'Audio stem separation endpoint',\r\n        method: 'POST',\r\n        body: {\r\n            fileName: 'string (required) - Name of the uploaded file',\r\n            fileId: 'string (optional) - ID from upload endpoint',\r\n            stems: 'string[] (optional) - Specific stems to extract',\r\n        },\r\n        availableStems: STEM_TYPES,\r\n        responseFields: {\r\n            jobId: 'Unique job identifier',\r\n            stems: 'Array of stem statuses',\r\n            estimatedTime: 'Estimated processing time in seconds',\r\n            statusEndpoint: 'Endpoint to check job status',\r\n        },\r\n        relatedEndpoints: {\r\n            upload: 'POST /api/upload - Upload audio file first',\r\n            health: 'GET /api/health - Check service status',\r\n        }\r\n    });\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\Documents\\AI\\Singscape\\frontend\\src\\app\\api\\upload\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\Documents\\AI\\Singscape\\frontend\\src\\app\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\Documents\\AI\\Singscape\\frontend\\src\\app\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Mic2' is defined but never used.","line":5,"column":30,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":34,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Mic2"},"fix":{"range":[132,138],"text":""},"desc":"Remove unused variable \"Mic2\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Drum' is defined but never used.","line":5,"column":36,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":40,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Drum"},"fix":{"range":[138,144],"text":""},"desc":"Remove unused variable \"Drum\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Guitar' is defined but never used.","line":5,"column":42,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":48,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Guitar"},"fix":{"range":[144,152],"text":""},"desc":"Remove unused variable \"Guitar\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Waves' is defined but never used.","line":5,"column":50,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":55,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Waves"},"fix":{"range":[152,159],"text":""},"desc":"Remove unused variable \"Waves\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'STEM_CONFIG' is defined but never used.","line":7,"column":21,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":32,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"STEM_CONFIG"},"fix":{"range":[278,291],"text":""},"desc":"Remove unused variable \"STEM_CONFIG\"."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport React, { useState, useCallback } from 'react';\nimport dynamic from 'next/dynamic';\nimport { ArrowRight, Music2, Mic2, Drum, Guitar, Waves, Zap, Shield, Download } from 'lucide-react';\nimport { Button } from '@/components/ui/ProgressBar';\nimport { AudioFile, STEM_CONFIG } from '@/types/audio';\n\nconst FileUpload = dynamic(\n  () => import('@/components/ui/FileUpload').then((mod) => mod.FileUpload),\n  {\n    ssr: false,\n    loading: () => (\n      <div className=\"w-full max-w-2xl mx-auto h-96 bg-zinc-900/50 animate-pulse border border-zinc-800 flex items-center justify-center\">\n        <span className=\"text-zinc-500 font-mono\">LOADING UPLOADER...</span>\n      </div>\n    ),\n  }\n);\n\nimport { SkeuomorphicHero } from '@/components/ui/SkeuomorphicHero';\n\nexport default function HomePage() {\n  const [selectedFile, setSelectedFile] = useState<AudioFile | null>(null);\n\n  const handleFileSelect = useCallback((file: AudioFile) => {\n    setSelectedFile(file);\n  }, []);\n\n  const handleStartProcessing = useCallback(() => {\n    if (selectedFile) {\n      // Store file info in sessionStorage for processing page\n      sessionStorage.setItem('audioFile', JSON.stringify({\n        name: selectedFile.name,\n        size: selectedFile.size,\n        duration: selectedFile.duration,\n      }));\n      // Navigate to processing page\n      window.location.href = '/process';\n    }\n  }, [selectedFile]);\n\n  return (\n    <div className=\"min-h-screen\">\n      {/* Hero Section - Skeuomorphic */}\n      <SkeuomorphicHero />\n\n      {/* Upload Section */}\n      <section id=\"upload\" className=\"py-12 px-4\">\n        <div className=\"max-w-4xl mx-auto\">\n          <div className=\"glass rounded-3xl p-8 sm:p-12\">\n            <h2 className=\"text-2xl sm:text-3xl font-bold text-center mb-8\">\n              Upload Your Audio\n            </h2>\n\n            <FileUpload onFileSelect={handleFileSelect} />\n\n            {selectedFile && (\n              <div className=\"mt-8 text-center\">\n                <Button\n                  size=\"lg\"\n                  onClick={handleStartProcessing}\n                  icon={<ArrowRight className=\"w-5 h-5\" />}\n                  data-testid=\"start-processing-btn\"\n                >\n                  Start Processing\n                </Button>\n                <p className=\"text-sm text-foreground/50 mt-4\">\n                  Processing happens in your browser ÔÇó Your files never leave your device\n                </p>\n              </div>\n            )}\n          </div>\n        </div>\n      </section>\n\n      {/* Features Section */}\n      <section id=\"features\" className=\"py-20 px-4\">\n        <div className=\"max-w-7xl mx-auto\">\n          <h2 className=\"text-3xl sm:text-4xl font-bold text-center mb-16\">\n            Why Choose <span className=\"text-sky-400\">StemSplit</span>?\n          </h2>\n\n          <div className=\"grid md:grid-cols-3 gap-8\">\n            {/* Feature 1 */}\n            <div className=\"glass rounded-2xl p-8 text-center\">\n              <div className=\"w-14 h-14 rounded-2xl bg-sky-500/20 flex items-center justify-center mx-auto mb-6\">\n                <Zap className=\"w-7 h-7 text-sky-500\" />\n              </div>\n              <h3 className=\"text-xl font-semibold mb-3\">AI-Powered Quality</h3>\n              <p className=\"text-foreground/60\">\n                Built on state-of-the-art Demucs model for professional-grade stem separation.\n              </p>\n            </div>\n\n            {/* Feature 2 */}\n            <div className=\"glass rounded-2xl p-8 text-center\">\n              <div className=\"w-14 h-14 rounded-2xl bg-emerald-500/20 flex items-center justify-center mx-auto mb-6\">\n                <Shield className=\"w-7 h-7 text-emerald-500\" />\n              </div>\n              <h3 className=\"text-xl font-semibold mb-3\">100% Private</h3>\n              <p className=\"text-foreground/60\">\n                All processing happens in your browser. Your audio files never leave your device.\n              </p>\n            </div>\n\n            {/* Feature 3 */}\n            <div className=\"glass rounded-2xl p-8 text-center\">\n              <div className=\"w-14 h-14 rounded-2xl bg-amber-500/20 flex items-center justify-center mx-auto mb-6\">\n                <Download className=\"w-7 h-7 text-amber-500\" />\n              </div>\n              <h3 className=\"text-xl font-semibold mb-3\">Free Forever</h3>\n              <p className=\"text-foreground/60\">\n                No sign-up, no subscription, no limits. Use as much as you want, completely free.\n              </p>\n            </div>\n          </div>\n        </div>\n      </section>\n\n      {/* How It Works Section */}\n      <section id=\"how-it-works\" className=\"py-20 px-4\">\n        <div className=\"max-w-5xl mx-auto\">\n          <h2 className=\"text-3xl sm:text-4xl font-bold text-center mb-16\">\n            How It <span className=\"text-emerald-400\">Works</span>\n          </h2>\n\n          <div className=\"grid md:grid-cols-3 gap-8\">\n            {/* Step 1 */}\n            <div className=\"text-center\">\n              <div className=\"w-12 h-12 rounded-full bg-gradient-to-r from-sky-500 to-emerald-500 flex items-center justify-center mx-auto mb-6 text-xl font-bold text-white\">\n                1\n              </div>\n              <h3 className=\"text-xl font-semibold mb-3\">Upload</h3>\n              <p className=\"text-foreground/60\">\n                Drag and drop your MP3 or WAV file, or click to browse.\n              </p>\n            </div>\n\n            {/* Step 2 */}\n            <div className=\"text-center\">\n              <div className=\"w-12 h-12 rounded-full bg-gradient-to-r from-sky-500 to-emerald-500 flex items-center justify-center mx-auto mb-6 text-xl font-bold text-white\">\n                2\n              </div>\n              <h3 className=\"text-xl font-semibold mb-3\">Process</h3>\n              <p className=\"text-foreground/60\">\n                Our AI analyzes your audio and separates it into individual stems.\n              </p>\n            </div>\n\n            {/* Step 3 */}\n            <div className=\"text-center\">\n              <div className=\"w-12 h-12 rounded-full bg-gradient-to-r from-sky-500 to-emerald-500 flex items-center justify-center mx-auto mb-6 text-xl font-bold text-white\">\n                3\n              </div>\n              <h3 className=\"text-xl font-semibold mb-3\">Download</h3>\n              <p className=\"text-foreground/60\">\n                Preview each stem and download them individually or as a bundle.\n              </p>\n            </div>\n          </div>\n        </div>\n      </section>\n\n      {/* CTA Section */}\n      <section className=\"py-20 px-4\">\n        <div className=\"max-w-4xl mx-auto text-center\">\n          <div className=\"glass rounded-3xl p-12\">\n            <Music2 className=\"w-16 h-16 text-sky-500 mx-auto mb-6 animate-float\" />\n            <h2 className=\"text-3xl sm:text-4xl font-bold mb-4\">\n              Ready to Split Your First Track?\n            </h2>\n            <p className=\"text-foreground/60 mb-8 max-w-xl mx-auto\">\n              Join thousands of musicians, educators, and creators who use StemSplit for practice, learning, and remixing.\n            </p>\n            <Button\n              size=\"lg\"\n              onClick={() => document.getElementById('upload')?.scrollIntoView({ behavior: 'smooth' })}\n              icon={<ArrowRight className=\"w-5 h-5\" />}\n            >\n              Get Started Free\n            </Button>\n          </div>\n        </div>\n      </section>\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\Documents\\AI\\Singscape\\frontend\\src\\app\\process\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ArrowLeft' is defined but never used.","line":5,"column":31,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":40,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ArrowLeft"},"fix":{"range":[157,168],"text":""},"desc":"Remove unused variable \"ArrowLeft\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ProgressBar' is defined but never used.","line":6,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":21,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"ProgressBar"},"fix":{"range":[193,251],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'simulateStemSeparation' is defined but never used.","line":8,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":50,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"simulateStemSeparation"},"fix":{"range":[354,378],"text":""},"desc":"Remove unused variable \"simulateStemSeparation\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'jobId' is assigned a value but never used.","line":53,"column":25,"nodeType":"Identifier","messageId":"unusedVar","endLine":53,"endColumn":30},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'handleCancel' is assigned a value but never used.","line":170,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":170,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'getStemIcon' is assigned a value but never used.","line":180,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":180,"endColumn":22}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { useEffect, useState, useCallback } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport { Music2, AlertCircle, ArrowLeft } from 'lucide-react';\r\nimport { ProgressBar } from '@/components/ui/ProgressBar';\r\nimport { ProcessingStatus, StemResult, STEM_CONFIG } from '@/types/audio';\r\nimport { audioBufferToWav, simulateStemSeparation } from '@/lib/audio-utils';\r\n\r\nexport default function ProcessPage() {\r\n    const router = useRouter();\r\n    const [status, setStatus] = useState<ProcessingStatus>({\r\n        stage: 'idle',\r\n        progress: 0,\r\n        message: 'Initializing...',\r\n    });\r\n    const [error, setError] = useState<string | null>(null);\r\n\r\n    const [retryCount, setRetryCount] = useState(0);\r\n\r\n    useEffect(() => {\r\n        let isCancelled = false;\r\n        let pollInterval: NodeJS.Timeout;\r\n\r\n        const runProcessing = async () => {\r\n            // Get file info from sessionStorage\r\n            const fileInfoStr = sessionStorage.getItem('audioFile');\r\n\r\n            if (!fileInfoStr) {\r\n                setError('No audio file found. Please upload a file first.');\r\n                return;\r\n            }\r\n\r\n            const fileInfo = JSON.parse(fileInfoStr);\r\n\r\n            try {\r\n                // 1. Trigger Separation\r\n                setStatus({\r\n                    stage: 'loading-model',\r\n                    progress: 5,\r\n                    message: 'Initializing Demucs model...',\r\n                    estimatedTimeRemaining: 180, // Real AI takes time\r\n                });\r\n\r\n                const startResponse = await fetch('/api/separate', {\r\n                    method: 'POST',\r\n                    headers: { 'Content-Type': 'application/json' },\r\n                    body: JSON.stringify({ fileName: fileInfo.name }),\r\n                });\r\n\r\n                if (!startResponse.ok) throw new Error('Failed to start separation job');\r\n\r\n                const { jobId, statusEndpoint } = await startResponse.json();\r\n\r\n                // 2. Poll Status\r\n                pollInterval = setInterval(async () => {\r\n                    if (isCancelled) return;\r\n\r\n                    try {\r\n                        const statusRes = await fetch(statusEndpoint);\r\n                        if (!statusRes.ok) return; // Skip this tick if network blip\r\n\r\n                        const jobStatus = await statusRes.json();\r\n\r\n                        if (jobStatus.status === 'processing' || jobStatus.status === 'starting') {\r\n                            setStatus(prev => ({\r\n                                ...prev,\r\n                                stage: 'processing',\r\n                                progress: jobStatus.progress || prev.progress, // Use reported progress or keep current\r\n                                message: jobStatus.message || 'Separating stems...',\r\n                            }));\r\n                        } else if (jobStatus.status === 'completed') {\r\n                            clearInterval(pollInterval);\r\n\r\n                            // Transform result for UI\r\n                            // backend returns { stems: { vocals: \"path/to/wav\", ... } }\r\n                            const results: StemResult[] = [];\r\n\r\n                            // We need to fetch the actual audio buffers to allow playback in the browser\r\n                            // For MVP, we might just set the URL and load buffer on play?\r\n                            // The existing StemPlayer expects 'audioBuffer'.\r\n                            // Let's Load the buffers now (might be heavy) OR refactor Player to load on demand.\r\n                            // For strict fidelity to current UI, we'll try to load them.\r\n\r\n                            setStatus({\r\n                                stage: 'exporting',\r\n                                progress: 95,\r\n                                message: 'Finalizing stems...',\r\n                            });\r\n\r\n                            const stemPaths = jobStatus.stems; // { vocals: \"path\", ... }\r\n\r\n                            // Helper to fetch and decode\r\n                            const loadStem = async (name: string, relativePath: string) => {\r\n                                const response = await fetch(`/${relativePath}`); // public folder access\r\n                                const arrayBuffer = await response.arrayBuffer();\r\n                                const audioContext = new AudioContext(); // Browser dependent\r\n                                const audioBuffer = await audioContext.decodeAudioData(arrayBuffer);\r\n                                return { name, audioBuffer, url: `/${relativePath}` };\r\n                            };\r\n\r\n                            const loadedStems = await Promise.all(\r\n                                Object.entries(stemPaths).map(([name, path]) =>\r\n                                    loadStem(name, path as string)\r\n                                )\r\n                            );\r\n\r\n                            loadedStems.forEach(stem => {\r\n                                results.push({\r\n                                    name: stem.name as StemResult['name'],\r\n                                    label: STEM_CONFIG[stem.name].label,\r\n                                    color: STEM_CONFIG[stem.name].color,\r\n                                    audioBuffer: stem.audioBuffer,\r\n                                    url: stem.url,\r\n                                    blob: audioBufferToWav(stem.audioBuffer),\r\n                                    isPlaying: false,\r\n                                    volume: 1\r\n                                });\r\n                            });\r\n\r\n                            // Store results\r\n                            const resultsData = results.map(r => ({\r\n                                name: r.name,\r\n                                label: r.label,\r\n                                color: r.color,\r\n                                url: r.url,\r\n                            }));\r\n                            sessionStorage.setItem('stemResults', JSON.stringify(resultsData));\r\n\r\n                            setStatus({\r\n                                stage: 'complete',\r\n                                progress: 100,\r\n                                message: 'Processing complete!',\r\n                            });\r\n\r\n                            if (!isCancelled) router.push('/results');\r\n                        } else if (jobStatus.status === 'failed' || jobStatus.status === 'error') {\r\n                            throw new Error(jobStatus.error || 'Job failed on backend');\r\n                        }\r\n\r\n                    } catch (pollErr) {\r\n                        console.error('Polling error', pollErr);\r\n                        // Don't fail immediately on one poll error, but maybe track consecutive failures\r\n                    }\r\n                }, 2000);\r\n\r\n            } catch (err) {\r\n                console.error('Processing error:', err);\r\n                if (!isCancelled) {\r\n                    clearInterval(pollInterval);\r\n                    setError(err instanceof Error ? err.message : 'An error occurred during processing');\r\n                    setStatus({\r\n                        stage: 'error',\r\n                        progress: 0,\r\n                        message: 'Processing failed',\r\n                        error: err instanceof Error ? err.message : 'Unknown error',\r\n                    });\r\n                }\r\n            }\r\n        };\r\n\r\n        runProcessing();\r\n\r\n        return () => {\r\n            isCancelled = true;\r\n            if (pollInterval) clearInterval(pollInterval);\r\n        };\r\n    }, [router, retryCount]);\r\n\r\n    const handleCancel = useCallback(() => {\r\n        router.push('/');\r\n    }, [router]);\r\n\r\n    const handleRetry = useCallback(() => {\r\n        setError(null);\r\n        setRetryCount(c => c + 1);\r\n    }, []);\r\n\r\n    // Map stem names to icons\r\n    const getStemIcon = (name: string) => {\r\n        switch (name) {\r\n            case 'vocals': return <Music2 className=\"w-5 h-5\" />;\r\n            case 'no_vocals': return <div className=\"w-5 h-5 border-2 border-current rounded-full\" />;\r\n            default: return <Music2 className=\"w-5 h-5\" />;\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"min-h-screen flex items-center justify-center px-4 py-20 bg-leather\" data-testid=\"process-page-container\">\r\n            <div className=\"w-full max-w-2xl relative z-10\">\r\n\r\n                {/* Rack Mount Header */}\r\n                <div className=\"bg-metal-dark p-6 rounded-t-lg border-x border-t border-[#45362C] shadow-2xl relative overflow-hidden\">\r\n                    {/* Screws */}\r\n                    <div className=\"absolute top-4 left-4 w-3 h-3 rounded-full bg-zinc-700 shadow-inner flex items-center justify-center\"><div className=\"w-full h-[1px] bg-black rotate-45\" /></div>\r\n                    <div className=\"absolute top-4 right-4 w-3 h-3 rounded-full bg-zinc-700 shadow-inner flex items-center justify-center\"><div className=\"w-full h-[1px] bg-black rotate-45\" /></div>\r\n\r\n                    <div className=\"text-center\">\r\n                        <div className=\"inline-flex items-center gap-3 mb-2 opacity-80\">\r\n                            <div className={`w-2 h-2 rounded-full ${status.stage === 'error' ? 'bg-red-500' : 'bg-green-500'} led-glow animate-pulse`} />\r\n                            <span className=\"font-mono text-xs text-[#A8977A] tracking-[0.2em] uppercase\">Processing Unit Active</span>\r\n                        </div>\r\n                        <h1 className=\"text-3xl font-bold text-[#F2E8DC] font-outfit uppercase tracking-tight\">\r\n                            signal separation\r\n                        </h1>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Rack Units (Stems) */}\r\n                <div className=\"bg-[#161711] border-x border-[#45362C]\">\r\n                    {error ? (\r\n                        <div className=\"p-12 text-center bg-red-900/20\">\r\n                            <AlertCircle className=\"w-12 h-12 text-red-500 mx-auto mb-4\" />\r\n                            <p className=\"text-red-400 font-mono mb-6\">{error}</p>\r\n                            <button onClick={handleRetry} className=\"btn-tactile px-6 py-2 text-[#161711] font-bold rounded-sm\">RETRY SEQUENCE</button>\r\n                        </div>\r\n                    ) : (\r\n                        <div className=\"divide-y divide-black\">\r\n                            {Object.entries(STEM_CONFIG).map(([key, config], index) => {\r\n                                const isActive = status.message.toLowerCase().includes(key);\r\n                                const isComplete = status.progress > (15 + (index + 1) * 20) || status.stage === 'complete';\r\n\r\n                                // Calculate needle rotation (-45 to 45 deg)\r\n                                // If complete, peg to 45. If active, wiggle around 0. If waiting, -45.\r\n                                let rotation = -45;\r\n                                if (isComplete) rotation = 45;\r\n                                else if (isActive) rotation = -10 + (Math.random() * 20) + (status.progress / 3); // Simulated movement\r\n\r\n                                return (\r\n                                    <div key={key} className=\"rack-unit p-6 flex items-center justify-between group relative\">\r\n                                        {/* Screw details */}\r\n                                        <div className=\"absolute left-2 top-1/2 -translate-y-1/2 w-2 h-2 rounded-full bg-black/50\" />\r\n                                        <div className=\"absolute right-2 top-1/2 -translate-y-1/2 w-2 h-2 rounded-full bg-black/50\" />\r\n\r\n                                        <div className=\"flex items-center gap-6 pl-6\">\r\n                                            {/* Channel Label */}\r\n                                            <div className=\"w-24\">\r\n                                                <span className=\"block text-xs text-[#A8977A]/60 font-mono uppercase tracking-widest mb-1\">Channel</span>\r\n                                                <h3 className=\"text-xl font-bold text-[#F2E8DC] uppercase\">{config.label}</h3>\r\n                                            </div>\r\n\r\n                                            {/* Status LED */}\r\n                                            <div className=\"flex flex-col items-center gap-1\">\r\n                                                <div className={`w-3 h-3 rounded-full transition-all duration-300 ${isComplete ? 'bg-green-500 led-glow' : isActive ? 'bg-amber-500 animate-pulse' : 'bg-zinc-800'}`} />\r\n                                                <span className=\"text-[9px] font-mono text-zinc-600 uppercase\">Signal</span>\r\n                                            </div>\r\n                                        </div>\r\n\r\n                                        {/* Analog VU Meter */}\r\n                                        <div className=\"relative w-32 h-16 bg-[#F2E8DC] rounded-t-lg overflow-hidden border-2 border-[#161711] shadow-inner ml-auto mr-12 opacity-90\">\r\n                                            {/* Scale markings */}\r\n                                            <div className=\"absolute bottom-0 left-[10%] w-[1px] h-3 bg-black/30 origin-bottom transform -rotate-[30deg]\" />\r\n                                            <div className=\"absolute bottom-0 left-[50%] w-[1px] h-4 bg-black/30\" />\r\n                                            <div className=\"absolute bottom-0 right-[10%] w-[1px] h-3 bg-red-500/50 origin-bottom transform rotate-[30deg]\" />\r\n                                            <span className=\"absolute top-2 right-2 text-[8px] font-bold text-red-700\">PEAK</span>\r\n\r\n                                            {/* Needle */}\r\n                                            <div\r\n                                                className=\"absolute bottom-[-2px] left-1/2 w-[2px] h-14 bg-red-600 origin-bottom needle-transition z-10\"\r\n                                                style={{ transform: `translateX(-50%) rotate(${rotation}deg)` }}\r\n                                            />\r\n                                            {/* Pivot */}\r\n                                            <div className=\"absolute bottom-[-5px] left-1/2 -translate-x-1/2 w-4 h-4 bg-black rounded-full z-20\" />\r\n                                        </div>\r\n                                    </div>\r\n                                );\r\n                            })}\r\n                        </div>\r\n                    )}\r\n                </div>\r\n\r\n                {/* Rack Footer / Global Progress */}\r\n                <div className=\"bg-metal-dark p-6 rounded-b-lg border-x border-b border-[#45362C] shadow-2xl\">\r\n                    <div className=\"flex items-center gap-4\">\r\n                        <span className=\"font-mono text-xs text-[#A8977A] uppercase w-24\">Master Out</span>\r\n                        <div className=\"flex-1 h-3 bg-black rounded-full overflow-hidden border border-zinc-700 relative\">\r\n                            {/* Striped progress bar */}\r\n                            <div\r\n                                className=\"h-full bg-amber-600 transition-all duration-300\"\r\n                                style={{ width: `${status.progress}%` }}\r\n                            />\r\n                            {/* Hatching texture overlay */}\r\n                            <div className=\"absolute inset-0 w-full h-full bg-[repeating-linear-gradient(45deg,transparent,transparent_5px,rgba(0,0,0,0.2)_5px,rgba(0,0,0,0.2)_10px)] opacity-50\" />\r\n                        </div>\r\n                        <span className=\"font-mono text-xs text-[#F2E8DC] w-10 text-right\">{Math.round(status.progress)}%</span>\r\n                    </div>\r\n                </div>\r\n\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\Documents\\AI\\Singscape\\frontend\\src\\app\\results\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Button' is defined but never used.","line":9,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":16,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"Button"},"fix":{"range":[325,378],"text":""},"desc":"Remove unused import declaration."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { useEffect, useState } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport dynamic from 'next/dynamic';\r\nimport Link from 'next/link';\r\nimport { Music2, ArrowLeft, Upload, CheckCircle2, Sparkles } from 'lucide-react';\r\nimport { StemResult, STEM_CONFIG } from '@/types/audio';\r\nimport { Button } from '@/components/ui/ProgressBar';\r\n\r\nconst StemGrid = dynamic(\r\n    () => import('@/components/ui/StemPlayer').then((mod) => mod.StemGrid),\r\n    {\r\n        ssr: false,\r\n        loading: () => (\r\n            <div className=\"w-full h-96 bg-zinc-900/50 animate-pulse border border-zinc-800 flex items-center justify-center\">\r\n                <span className=\"text-zinc-500 font-mono\">LOADING STEMS...</span>\r\n            </div>\r\n        ),\r\n    }\r\n);\r\n\r\ninterface StoredStemResult {\r\n    name: 'vocals' | 'drums' | 'bass' | 'other';\r\n    label: string;\r\n    color: string;\r\n    url: string;\r\n}\r\n\r\nexport default function ResultsPage() {\r\n    const router = useRouter();\r\n    const [stems, setStems] = useState<StemResult[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [originalFileName, setOriginalFileName] = useState<string>('');\r\n\r\n    useEffect(() => {\r\n        // Get results from sessionStorage\r\n        const resultsStr = sessionStorage.getItem('stemResults');\r\n        const fileInfoStr = sessionStorage.getItem('audioFile');\r\n\r\n        if (!resultsStr) {\r\n            // No results, redirect to home\r\n            router.push('/');\r\n            return;\r\n        }\r\n\r\n        try {\r\n            const storedResults: StoredStemResult[] = JSON.parse(resultsStr);\r\n            const fileInfo = fileInfoStr ? JSON.parse(fileInfoStr) : null;\r\n\r\n            if (fileInfo) {\r\n                setOriginalFileName(fileInfo.name);\r\n            }\r\n\r\n            // Convert stored results to StemResult format\r\n            const stemResults: StemResult[] = storedResults\r\n                .filter(r => STEM_CONFIG[r.name]) // Filter out stale stems (drums, bass, etc.)\r\n                .map(r => ({\r\n                    name: r.name as StemResult['name'], // Safe cast after filter\r\n                    label: r.label,\r\n                    color: r.color,\r\n                    audioBuffer: null,\r\n                    blob: null, // Will be recreated from URL if needed\r\n                    url: r.url,\r\n                    isPlaying: false,\r\n                    volume: 1,\r\n                }));\r\n\r\n            setStems(stemResults);\r\n            setLoading(false);\r\n        } catch {\r\n            console.error('Error loading results');\r\n            router.push('/');\r\n        }\r\n    }, [router]);\r\n\r\n    const handleProcessAnother = () => {\r\n        // Clear session storage\r\n        sessionStorage.removeItem('audioFile');\r\n        sessionStorage.removeItem('audioFileData');\r\n        sessionStorage.removeItem('stemResults');\r\n        router.push('/');\r\n    };\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"min-h-screen flex items-center justify-center\">\r\n                <div className=\"text-center\">\r\n                    <div className=\"w-16 h-16 rounded-2xl bg-gradient-to-br from-sky-500 to-emerald-500 flex items-center justify-center mx-auto mb-4 animate-pulse\">\r\n                        <Music2 className=\"w-8 h-8 text-white\" />\r\n                    </div>\r\n                    <p className=\"text-foreground/60\">Loading results...</p>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"min-h-screen py-20 px-4 bg-leather\">\r\n            <div className=\"max-w-6xl mx-auto\">\r\n                {/* Mixing Desk Header */}\r\n                <div className=\"text-center mb-16 relative\">\r\n                    <div className=\"inline-block relative mb-6\">\r\n                        <div className=\"w-20 h-20 rounded-full bg-metal-brushed border-4 border-[#2A2B24] flex items-center justify-center shadow-xl z-10 relative\">\r\n                            <CheckCircle2 className=\"w-10 h-10 text-[#45362C]\" />\r\n                        </div>\r\n                        {/* Status light */}\r\n                        <div className=\"absolute top-0 right-0 w-4 h-4 rounded-full bg-green-500 led-glow animate-pulse\" />\r\n                    </div>\r\n\r\n                    <h1 className=\"text-4xl sm:text-5xl font-bold font-outfit tracking-tight text-[#F2E8DC] mb-2\">\r\n                        Session Complete\r\n                    </h1>\r\n\r\n                    <p className=\"text-lg text-[#A8977A]/80 font-mono tracking-wide\">\r\n                        {originalFileName ? (\r\n                            <>MASTER TAPE: <span className=\"text-[#F2E8DC] uppercase\">{originalFileName}</span></>\r\n                        ) : (\r\n                            'STEMS READY FOR MIXDOWN'\r\n                        )}\r\n                    </p>\r\n                </div>\r\n\r\n                {/* Console Surface */}\r\n                <div className=\"bg-metal-dark rounded-xl p-8 border border-[#45362C] shadow-2xl relative\">\r\n                    {/* Metal Screws */}\r\n                    <div className=\"absolute top-4 left-4 w-3 h-3 rounded-full bg-zinc-700 shadow-inner flex items-center justify-center\"><div className=\"w-full h-[1px] bg-black rotate-45\" /></div>\r\n                    <div className=\"absolute top-4 right-4 w-3 h-3 rounded-full bg-zinc-700 shadow-inner flex items-center justify-center\"><div className=\"w-full h-[1px] bg-black rotate-45\" /></div>\r\n                    <div className=\"absolute bottom-4 left-4 w-3 h-3 rounded-full bg-zinc-700 shadow-inner flex items-center justify-center\"><div className=\"w-full h-[1px] bg-black rotate-45\" /></div>\r\n                    <div className=\"absolute bottom-4 right-4 w-3 h-3 rounded-full bg-zinc-700 shadow-inner flex items-center justify-center\"><div className=\"w-full h-[1px] bg-black rotate-45\" /></div>\r\n\r\n                    <div className=\"flex items-center justify-between mb-8 border-b border-black/50 pb-4\">\r\n                        <h2 className=\"text-xl font-bold font-outfit text-[#A8977A] uppercase tracking-widest flex items-center gap-2\">\r\n                            <Sparkles className=\"w-5 h-5\" />\r\n                            Console Strips\r\n                        </h2>\r\n                        <span className=\"text-xs font-mono text-zinc-500 bg-black/30 px-2 py-1 rounded\">\r\n                            {stems.length} CHANNELS ACTIVE\r\n                        </span>\r\n                    </div>\r\n\r\n                    <StemGrid stems={stems} />\r\n                </div>\r\n\r\n                {/* Footer Controls */}\r\n                <div className=\"mt-12 flex flex-col sm:flex-row items-center justify-center gap-8\">\r\n                    {/* Tactile Buttons */}\r\n                    <button\r\n                        onClick={handleProcessAnother}\r\n                        className=\"btn-tactile px-8 py-4 text-[#161711] font-bold uppercase rounded-sm flex items-center gap-3 active:scale-95\"\r\n                    >\r\n                        <Upload className=\"w-5 h-5\" />\r\n                        Load New Tape\r\n                    </button>\r\n\r\n                    <Link href=\"/\">\r\n                        <button className=\"text-[#A8977A] hover:text-[#F2E8DC] font-mono text-sm tracking-widest uppercase transition-colors flex items-center gap-2\">\r\n                            <ArrowLeft className=\"w-4 h-4\" />\r\n                            Return to Storage\r\n                        </button>\r\n                    </Link>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\Documents\\AI\\Singscape\\frontend\\src\\components\\layout\\index.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\Documents\\AI\\Singscape\\frontend\\src\\components\\ui\\FileUpload.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'FileAudio' is defined but never used.","line":4,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":27,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"FileAudio"},"fix":{"range":[87,98],"text":""},"desc":"Remove unused variable \"FileAudio\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'formatFileSize' is assigned a value but never used.","line":116,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":116,"endColumn":25},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'formatDuration' is assigned a value but never used.","line":122,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":122,"endColumn":25}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { useCallback, useState } from 'react';\r\nimport { Upload, FileAudio, X, AlertCircle } from 'lucide-react';\r\nimport { AudioFile, FILE_CONSTRAINTS } from '@/types/audio';\r\n\r\ninterface FileUploadProps {\r\n    onFileSelect: (file: AudioFile) => void;\r\n    disabled?: boolean;\r\n}\r\n\r\nexport function FileUpload({ onFileSelect, disabled = false }: FileUploadProps) {\r\n    const [isDragging, setIsDragging] = useState(false);\r\n    const [error, setError] = useState<string | null>(null);\r\n    const [selectedFile, setSelectedFile] = useState<AudioFile | null>(null);\r\n\r\n    const validateFile = useCallback((file: File): string | null => {\r\n        // Check file type\r\n        const isValidType = FILE_CONSTRAINTS.acceptedTypes.includes(file.type) ||\r\n            FILE_CONSTRAINTS.acceptedExtensions.some(ext => file.name.toLowerCase().endsWith(ext));\r\n\r\n        if (!isValidType) {\r\n            return 'Only MP3 or WAV files supported';\r\n        }\r\n\r\n        // Check file size\r\n        if (file.size > FILE_CONSTRAINTS.maxSize) {\r\n            return `Max file size is ${FILE_CONSTRAINTS.maxSize / (1024 * 1024)}MB`;\r\n        }\r\n\r\n        return null;\r\n    }, []);\r\n\r\n    const getAudioDuration = (file: File): Promise<number> => {\r\n        return new Promise((resolve, reject) => {\r\n            const audio = new Audio();\r\n            audio.preload = 'metadata';\r\n\r\n            audio.onloadedmetadata = () => {\r\n                URL.revokeObjectURL(audio.src);\r\n                resolve(audio.duration);\r\n            };\r\n\r\n            audio.onerror = () => {\r\n                URL.revokeObjectURL(audio.src);\r\n                reject(new Error('Could not load audio file'));\r\n            };\r\n\r\n            audio.src = URL.createObjectURL(file);\r\n        });\r\n    };\r\n\r\n    const handleFile = useCallback(async (file: File) => {\r\n        setError(null);\r\n\r\n        const validationError = validateFile(file);\r\n        if (validationError) {\r\n            setError(validationError);\r\n            return;\r\n        }\r\n\r\n        try {\r\n            const duration = await getAudioDuration(file);\r\n\r\n            const audioFile: AudioFile = {\r\n                name: file.name,\r\n                size: file.size,\r\n                duration,\r\n                file,\r\n                url: URL.createObjectURL(file), // Still valid in browser\r\n            };\r\n\r\n            setSelectedFile(audioFile);\r\n            onFileSelect(audioFile);\r\n        } catch {\r\n            setError('Could not read audio file. Please try another file.');\r\n        }\r\n    }, [validateFile, onFileSelect]);\r\n\r\n    const handleDrop = useCallback((e: React.DragEvent<HTMLDivElement>) => {\r\n        e.preventDefault();\r\n        setIsDragging(false);\r\n\r\n        if (disabled) return;\r\n\r\n        const file = e.dataTransfer.files[0];\r\n        if (file) {\r\n            handleFile(file);\r\n        }\r\n    }, [disabled, handleFile]);\r\n\r\n    const handleDragOver = useCallback((e: React.DragEvent<HTMLDivElement>) => {\r\n        e.preventDefault();\r\n        if (!disabled) {\r\n            setIsDragging(true);\r\n        }\r\n    }, [disabled]);\r\n\r\n    const handleDragLeave = useCallback((e: React.DragEvent<HTMLDivElement>) => {\r\n        e.preventDefault();\r\n        setIsDragging(false);\r\n    }, []);\r\n\r\n    const handleInputChange = useCallback((e: React.ChangeEvent<HTMLInputElement>) => {\r\n        const file = e.target.files?.[0];\r\n        if (file) {\r\n            handleFile(file);\r\n        }\r\n    }, [handleFile]);\r\n\r\n    const clearFile = useCallback(() => {\r\n        setSelectedFile(null);\r\n        setError(null);\r\n    }, []);\r\n\r\n    const formatFileSize = (bytes: number): string => {\r\n        if (bytes < 1024) return `${bytes} B`;\r\n        if (bytes < 1024 * 1024) return `${(bytes / 1024).toFixed(1)} KB`;\r\n        return `${(bytes / (1024 * 1024)).toFixed(1)} MB`;\r\n    };\r\n\r\n    const formatDuration = (seconds: number): string => {\r\n        const mins = Math.floor(seconds / 60);\r\n        const secs = Math.floor(seconds % 60);\r\n        return `${mins}:${secs.toString().padStart(2, '0')}`;\r\n    };\r\n\r\n    return (\r\n        <div className=\"w-full max-w-2xl mx-auto font-outfit perspective-1000\">\r\n            {/* Tape Deck Chassis */}\r\n            <div className=\"relative bg-metal-dark p-8 rounded-sm shadow-2xl border-t border-white/10 border-b border-black/50\">\r\n\r\n                {/* Screw Heads */}\r\n                <div className=\"absolute top-2 left-2 w-2 h-2 rounded-full bg-zinc-700 shadow-inner flex items-center justify-center\"><div className=\"w-full h-[1px] bg-black rotate-45\" /></div>\r\n                <div className=\"absolute top-2 right-2 w-2 h-2 rounded-full bg-zinc-700 shadow-inner flex items-center justify-center\"><div className=\"w-full h-[1px] bg-black rotate-45\" /></div>\r\n                <div className=\"absolute bottom-2 left-2 w-2 h-2 rounded-full bg-zinc-700 shadow-inner flex items-center justify-center\"><div className=\"w-full h-[1px] bg-black rotate-45\" /></div>\r\n                <div className=\"absolute bottom-2 right-2 w-2 h-2 rounded-full bg-zinc-700 shadow-inner flex items-center justify-center\"><div className=\"w-full h-[1px] bg-black rotate-45\" /></div>\r\n\r\n                {/* Drop Zone / Tape Slot */}\r\n                <div\r\n                    onDrop={handleDrop}\r\n                    onDragOver={handleDragOver}\r\n                    onDragLeave={handleDragLeave}\r\n                    className={`\r\n                        relative transition-all duration-300 slot-inset rounded-lg p-2 overflow-hidden\r\n                        ${isDragging ? 'shadow-[0_0_15px_#A8977A] border-[#A8977A]/50' : ''}\r\n                        ${disabled ? 'opacity-50 cursor-not-allowed' : 'cursor-pointer'}\r\n                    `}\r\n                    style={{ minHeight: '200px' }}\r\n                >\r\n                    {/* Content Container */}\r\n                    <div className=\"relative h-full flex flex-col items-center justify-center text-center p-8\">\r\n\r\n                        {selectedFile ? (\r\n                            /* Cassette Tape Visual */\r\n                            <div className=\"w-full animate-in slide-in-from-top duration-500 ease-out\">\r\n                                <div className=\"bg-[#1C1D18] border-2 border-[#2A2B24] rounded-md p-4 relative shadow-lg\">\r\n                                    {/* Cassette Texture */}\r\n                                    <div className=\"absolute inset-0 bg-[url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPSc0JyBoZWlnaHQ9JzQnPgo8cmVjdCB3aWR0aD0nNCcgaGVpZ2h0PSI0IiBmaWxsPSIjZmZmIiBmaWxsLW9wYWNpdHk9IjAuMDUiLz4KPC9zdmc+')] opacity-20\" />\r\n\r\n                                    {/* Label Area */}\r\n                                    <div className=\"bg-[#F2E8DC] h-24 rounded-sm mb-4 relative overflow-hidden flex items-center justify-center p-4 border border-[#D4C5A9]\">\r\n                                        {/* Handwriting Font */}\r\n                                        <p className=\"font-bold text-2xl text-[#161711] font-mono truncate uppercase tracking-tighter\" style={{ fontFamily: '\"Courier New\", Courier, monospace' }}>\r\n                                            {selectedFile.name}\r\n                                        </p>\r\n                                        <div className=\"absolute top-0 left-0 w-full h-1 bg-red-500/20\" />\r\n                                        <div className=\"absolute bottom-0 left-0 w-full h-1 bg-red-500/20\" />\r\n                                    </div>\r\n\r\n                                    {/* Spools */}\r\n                                    <div className=\"flex justify-center gap-12 px-8\">\r\n                                        <div className=\"w-12 h-12 rounded-full border-4 border-white/20 flex items-center justify-center animate-spin-slow\">\r\n                                            <div className=\"w-full h-1 bg-white/20 rotate-0\" />\r\n                                            <div className=\"w-full h-[1px] absolute bg-white/20 rotate-90\" />\r\n                                        </div>\r\n                                        <div className=\"w-12 h-12 rounded-full border-4 border-white/20 flex items-center justify-center animate-spin-slow\">\r\n                                            <div className=\"w-full h-1 bg-white/20 rotate-0\" />\r\n                                            <div className=\"w-full h-[1px] absolute bg-white/20 rotate-90\" />\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    {/* Clear Button (Eject) */}\r\n                                    <button\r\n                                        onClick={(e) => {\r\n                                            e.stopPropagation();\r\n                                            clearFile();\r\n                                        }}\r\n                                        className=\"absolute top-2 right-2 p-2 bg-[#8B3A3A] hover:bg-red-600 text-white rounded-sm shadow-md transition-colors\"\r\n                                        title=\"Eject Tape\"\r\n                                    >\r\n                                        <X className=\"w-4 h-4\" />\r\n                                    </button>\r\n                                </div>\r\n\r\n                                {/* Status Light */}\r\n                                <div className=\"mt-6 flex justify-center items-center gap-3\">\r\n                                    <div className=\"w-3 h-3 rounded-full bg-green-500 led-glow animate-pulse\" />\r\n                                    <span className=\"text-[#A8977A] font-mono text-xs tracking-widest uppercase\">Tape Loaded ÔÇó Ready</span>\r\n                                </div>\r\n                            </div>\r\n                        ) : (\r\n                            /* Empty Slot Prompt */\r\n                            <label className={`block w-full h-full flex flex-col items-center justify-center gap-6 ${disabled ? 'cursor-not-allowed' : 'cursor-pointer'}`}>\r\n                                <input\r\n                                    type=\"file\"\r\n                                    accept=\".mp3,.wav,audio/mpeg,audio/wav\"\r\n                                    onChange={handleInputChange}\r\n                                    disabled={disabled}\r\n                                    className=\"sr-only\"\r\n                                    data-testid=\"file-upload-input\"\r\n                                />\r\n\r\n                                {/* Slot Visual */}\r\n                                <div className={`\r\n                                    w-full h-full absolute inset-0 \r\n                                    bg-[repeating-linear-gradient(45deg,transparent,transparent_10px,rgba(0,0,0,0.5)_10px,rgba(0,0,0,0.5)_20px)] \r\n                                    opacity-20 pointer-events-none transition-opacity duration-300\r\n                                    ${isDragging ? 'opacity-0' : 'opacity-20'}\r\n                                `} />\r\n\r\n                                <div className={`\r\n                                    w-24 h-24 border-4 border-dashed border-[#45362C] rounded-lg flex items-center justify-center transition-all duration-300 z-10\r\n                                    ${isDragging ? 'border-[#A8977A] scale-110 bg-[#A8977A]/10' : 'group-hover:border-[#F2E8DC]/50'}\r\n                                `}>\r\n                                    <Upload\r\n                                        className={`w-10 h-10 transition-colors duration-300 ${isDragging ? 'text-[#A8977A]' : 'text-[#45362C] group-hover:text-[#F2E8DC]'}`}\r\n                                    />\r\n                                </div>\r\n\r\n                                <div className=\"space-y-2 z-10 relative\">\r\n                                    <h3 className=\"text-2xl font-bold font-outfit text-[#F2E8DC] uppercase tracking-wide group-hover:text-[#A8977A] transition-colors\">\r\n                                        {isDragging ? 'Insert Tape' : 'Load Audio'}\r\n                                    </h3>\r\n                                    <p className=\"text-[#8F7D60] font-mono text-xs uppercase tracking-widest\">\r\n                                        MP3 / WAV ÔÇó Max 25MB\r\n                                    </p>\r\n                                </div>\r\n                            </label>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Error Message */}\r\n            {error && (\r\n                <div className=\"mt-6 p-4 bg-[#8B3A3A] text-white flex items-center gap-3 border border-[#45362C] shadow-lg\">\r\n                    <AlertCircle className=\"w-5 h-5 flex-shrink-0\" />\r\n                    <p className=\"text-sm font-bold uppercase tracking-wide\">{error}</p>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\Documents\\AI\\Singscape\\frontend\\src\\components\\ui\\LoginOverlay.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\Documents\\AI\\Singscape\\frontend\\src\\components\\ui\\ProgressBar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\Documents\\AI\\Singscape\\frontend\\src\\components\\ui\\SkeuomorphicHero.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ArrowRight' is defined but never used.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":20,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ArrowRight"},"fix":{"range":[79,90],"text":""},"desc":"Remove unused variable \"ArrowRight\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Disc' is defined but never used.","line":4,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":26,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Disc"},"fix":{"range":[89,95],"text":""},"desc":"Remove unused variable \"Disc\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Mic2' is defined but never used.","line":4,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":32,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Mic2"},"fix":{"range":[95,101],"text":""},"desc":"Remove unused variable \"Mic2\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Music2' is defined but never used.","line":4,"column":34,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":40,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Music2"},"fix":{"range":[101,109],"text":""},"desc":"Remove unused variable \"Music2\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Button' is defined but never used.","line":5,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":16,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"Button"},"fix":{"range":[146,185],"text":""},"desc":"Remove unused import declaration."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { useState, useEffect } from 'react';\r\nimport { ArrowRight, Disc, Mic2, Music2, Power, Zap } from 'lucide-react';\r\nimport { Button } from './ProgressBar';\r\n\r\nexport function SkeuomorphicHero() {\r\n    // Physics State\r\n    const [isOn, setIsOn] = useState(false);\r\n    const [rotation, setRotation] = useState(0);\r\n    const [speed, setSpeed] = useState(0); // 0 to 1 (1 = 33rpm)\r\n\r\n    // Inertia Loop\r\n    useEffect(() => {\r\n        let animationFrame: number;\r\n\r\n        const updatePhysics = () => {\r\n            // Target speed based on isOn state\r\n            const targetSpeed = isOn ? 1 : 0;\r\n\r\n            // Accelerate / Decelerate (Physics simulation)\r\n            if (speed < targetSpeed) {\r\n                setSpeed(s => Math.min(s + 0.02, targetSpeed)); // Spin up\r\n            } else if (speed > targetSpeed) {\r\n                setSpeed(s => Math.max(s - 0.01, targetSpeed)); // Spin down friction\r\n            }\r\n\r\n            if (speed > 0) {\r\n                setRotation(r => (r + (speed * 2)) % 360); // 2 degrees per frame at full speed\r\n            }\r\n\r\n            animationFrame = requestAnimationFrame(updatePhysics);\r\n        };\r\n\r\n        animationFrame = requestAnimationFrame(updatePhysics);\r\n        return () => cancelAnimationFrame(animationFrame);\r\n    }, [isOn, speed]);\r\n\r\n    const scrollToUpload = () => {\r\n        document.getElementById('upload')?.scrollIntoView({ behavior: 'smooth' });\r\n    };\r\n\r\n    return (\r\n        <section className=\"relative py-20 overflow-hidden transform-gpu bg-leather\">\r\n            <div className=\"max-w-7xl mx-auto px-4 grid lg:grid-cols-2 gap-16 items-center\">\r\n\r\n                {/* Left: Copy & CTA */}\r\n                <div className=\"relative z-10 text-left\">\r\n                    {/* Badge */}\r\n                    <div className=\"inline-flex items-center gap-2 px-3 py-1 rounded-sm bg-[#2A2B24] border border-[#45362C] mb-8 shadow-sm\">\r\n                        <div className={`w-2 h-2 rounded-full ${isOn && speed > 0.9 ? 'bg-primary led-glow' : 'bg-[#45362C]'} transition-all duration-300`} />\r\n                        <span className=\"text-xs tracking-[0.2em] font-bold text-[#A8977A] uppercase\">\r\n                            {isOn ? (speed > 0.9 ? \"System Ready\" : \"Spooling Up...\") : \"Standby\"}\r\n                        </span>\r\n                    </div>\r\n\r\n                    <h1 className=\"text-5xl sm:text-7xl font-bold mb-6 tracking-tight leading-none text-[#F2E8DC] glow-text\">\r\n                        Split Audio <br />\r\n                        <span className=\"text-primary italic font-serif\">Analog Style.</span>\r\n                    </h1>\r\n\r\n                    <p className=\"text-lg text-[#D4C5A9]/80 mb-10 max-w-xl leading-relaxed font-light\">\r\n                        Separate vocals and music with the warmth of analog design and the precision of AI.\r\n                        No sign-up required. Just pure, isolated sound.\r\n                    </p>\r\n\r\n                    <div className=\"flex items-center gap-6\">\r\n                        <button\r\n                            onClick={scrollToUpload}\r\n                            className=\"btn-tactile px-8 py-4 text-[#161711] font-bold text-lg rounded-sm uppercase tracking-wider flex items-center gap-3 active:scale-95\"\r\n                        >\r\n                            <Zap className=\"w-5 h-5 fill-current\" />\r\n                            Start Separation\r\n                        </button>\r\n\r\n                        <div className=\"flex gap-4\">\r\n                            {/* Decorative Knobs */}\r\n                            <div className=\"flex flex-col items-center gap-2 group\">\r\n                                <div className=\"w-12 h-12 rounded-full bg-metal-dark knob-shadow border border-[#45362C] relative transform transition-transform group-hover:rotate-45\">\r\n                                    <div className=\"absolute top-1 left-1/2 -translate-x-1/2 w-1 h-3 bg-white/50 rounded-full\" />\r\n                                </div>\r\n                                <span className=\"text-[10px] uppercase tracking-widest text-[#45362C]\">Gain</span>\r\n                            </div>\r\n                            <div className=\"flex flex-col items-center gap-2 group\">\r\n                                <div className=\"w-12 h-12 rounded-full bg-metal-dark knob-shadow border border-[#45362C] relative transform transition-transform group-hover:-rotate-45\">\r\n                                    <div className=\"absolute top-1 left-1/2 -translate-x-1/2 w-1 h-3 bg-white/50 rounded-full\" />\r\n                                </div>\r\n                                <span className=\"text-[10px] uppercase tracking-widest text-[#45362C]\">Freq</span>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Right: The Physical Device */}\r\n                <div className=\"relative z-0 lg:h-[600px] flex items-center justify-center\">\r\n                    {/* The Device Chassis */}\r\n                    <div className=\"relative w-full max-w-md aspect-square bg-metal-dark rounded-sm border-8 border-[#2A2B24] shadow-2xl p-8 flex flex-col items-center justify-center\">\r\n\r\n                        {/* Metallic Screw details */}\r\n                        <div className=\"absolute top-4 left-4 w-3 h-3 rounded-full bg-zinc-700 shadow-inner flex items-center justify-center\"><div className=\"w-full h-[1px] bg-black rotate-45\" /></div>\r\n                        <div className=\"absolute top-4 right-4 w-3 h-3 rounded-full bg-zinc-700 shadow-inner flex items-center justify-center\"><div className=\"w-full h-[1px] bg-black rotate-45\" /></div>\r\n                        <div className=\"absolute bottom-4 left-4 w-3 h-3 rounded-full bg-zinc-700 shadow-inner flex items-center justify-center\"><div className=\"w-full h-[1px] bg-black rotate-45\" /></div>\r\n                        <div className=\"absolute bottom-4 right-4 w-3 h-3 rounded-full bg-zinc-700 shadow-inner flex items-center justify-center\"><div className=\"w-full h-[1px] bg-black rotate-45\" /></div>\r\n\r\n                        {/* Vinyl Platter */}\r\n                        <div className=\"relative w-64 h-64 rounded-full bg-zinc-900 border-4 border-[#111] shadow-2xl flex items-center justify-center\"\r\n                            style={{ transform: `rotate(${rotation}deg)` }}\r\n                        >\r\n                            {/* Strobe Dots (Visual) */}\r\n                            <div className=\"absolute inset-2 rounded-full border border-dashed border-zinc-700/50\" />\r\n\r\n                            {/* Real Vinyl Texture */}\r\n                            <div className=\"absolute inset-0 rounded-full vinyl-grooves opacity-90\" />\r\n\r\n                            {/* Anisotropic Reflection (Static relative to light, but we rotate the disc) \r\n                                Actually, for vinyl, reflection moves. We'll simulate a 'shine' overlay that stays static\r\n                                but the texture moves. */}\r\n                            <div className=\"absolute inset-0 rounded-full bg-gradient-to-tr from-white/10 via-transparent to-transparent pointer-events-none\" style={{ transform: `rotate(-${rotation}deg)` }} />\r\n\r\n                            {/* Label */}\r\n                            <div className=\"w-24 h-24 rounded-full bg-primary border-4 border-[#161711] flex items-center justify-center shadow-inner z-10 relative\">\r\n                                <span className=\"font-outfit font-bold text-[#161711] text-xs tracking-widest uppercase\" style={{ transform: `rotate(${rotation}deg)` }}>StemSplit</span>\r\n                                {/* Spindle */}\r\n                                <div className=\"absolute w-2 h-2 bg-zinc-300 rounded-full top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 shadow-sm\" />\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Tonearm (Physics movement) */}\r\n                        <div className={`absolute top-10 right-10 w-4 h-32 bg-[#45362C] origin-top rounded-full shadow-xl transition-transform duration-[2000ms] border border-[#2A2B24] z-20 ease-out`}\r\n                            style={{ transform: isOn ? 'rotate(25deg)' : 'rotate(0deg)' }}\r\n                        >\r\n                            {/* Head shell */}\r\n                            <div className=\"absolute bottom-0 w-8 h-12 bg-metal-brushed -left-2 rounded-md shadow-md border border-zinc-600\" />\r\n                            {/* Counterweight */}\r\n                            <div className=\"absolute -top-2 left-1/2 -translate-x-1/2 w-6 h-8 bg-zinc-400 rounded-sm shadow-md\" />\r\n                        </div>\r\n\r\n                        {/* Controls Panel */}\r\n                        <div className=\"absolute bottom-8 w-full px-12 flex justify-between items-center z-30\">\r\n                            <div className=\"flex flex-col items-center gap-1\">\r\n                                <div className={`w-3 h-3 rounded-full ${isOn ? 'bg-red-500 led-glow' : 'bg-red-900'} transition-colors`} />\r\n                                <span className=\"text-[10px] font-mono text-zinc-500\">REC</span>\r\n                            </div>\r\n\r\n                            <button\r\n                                onClick={() => setIsOn(!isOn)}\r\n                                className=\"w-16 h-16 rounded-full bg-metal-brushed border-4 border-[#2A2B24] flex items-center justify-center shadow-lg active:scale-95 transition-transform\"\r\n                            >\r\n                                <Power className={`w-6 h-6 ${isOn ? 'text-primary' : 'text-zinc-600'} drop-shadow-md`} />\r\n                            </button>\r\n\r\n                            <div className=\"flex flex-col items-center gap-1\">\r\n                                <div className={`w-3 h-3 rounded-full ${isOn ? 'bg-green-500 led-glow' : 'bg-green-900'} transition-colors`} />\r\n                                <span className=\"text-[10px] font-mono text-zinc-500\">PWR</span>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Background decorations */}\r\n                    <div className=\"absolute -z-10 top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[120%] h-[120%] bg-primary/5 blur-3xl rounded-full\" />\r\n                </div>\r\n            </div>\r\n        </section>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\Documents\\AI\\Singscape\\frontend\\src\\components\\ui\\StemPlayer.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'handleSeek' is assigned a value but never used.","line":92,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":92,"endColumn":21}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { useRef, useState, useEffect, useCallback } from 'react';\r\nimport { Play, Pause, Volume2, VolumeX, Download } from 'lucide-react';\r\nimport { StemResult, STEM_CONFIG } from '@/types/audio';\r\nimport { formatDuration } from '@/lib/audio-utils';\r\nimport dynamic from 'next/dynamic';\r\n\r\nconst WaveformVisualizer = dynamic(\r\n    () => import('./WaveformVisualizer').then((mod) => mod.WaveformVisualizer),\r\n    {\r\n        ssr: false,\r\n        loading: () => <div className=\"h-16 w-full bg-zinc-900/50 animate-pulse border border-zinc-800\" />\r\n    }\r\n);\r\n\r\ninterface StemPlayerProps {\r\n    stem: StemResult;\r\n    onPlayStateChange?: (isPlaying: boolean) => void;\r\n}\r\n\r\nexport function StemPlayer({ stem, onPlayStateChange }: StemPlayerProps) {\r\n    const audioRef = useRef<HTMLAudioElement>(null);\r\n    const [isPlaying, setIsPlaying] = useState(false);\r\n    const [volume, setVolume] = useState(1);\r\n    const [isMuted, setIsMuted] = useState(false);\r\n    const [currentTime, setCurrentTime] = useState(0);\r\n    const [duration, setDuration] = useState(0);\r\n\r\n    const config = STEM_CONFIG[stem.name] || { label: stem.name, color: '#808080' };\r\n\r\n    useEffect(() => {\r\n        const audio = audioRef.current;\r\n        if (!audio) return;\r\n\r\n        const handleTimeUpdate = () => setCurrentTime(audio.currentTime);\r\n        const handleDurationChange = () => setDuration(audio.duration);\r\n        const handleEnded = () => {\r\n            setIsPlaying(false);\r\n            onPlayStateChange?.(false);\r\n        };\r\n\r\n        audio.addEventListener('timeupdate', handleTimeUpdate);\r\n        audio.addEventListener('durationchange', handleDurationChange);\r\n        audio.addEventListener('ended', handleEnded);\r\n\r\n        return () => {\r\n            audio.removeEventListener('timeupdate', handleTimeUpdate);\r\n            audio.removeEventListener('durationchange', handleDurationChange);\r\n            audio.removeEventListener('ended', handleEnded);\r\n        };\r\n    }, [onPlayStateChange]);\r\n\r\n    const togglePlay = useCallback(() => {\r\n        const audio = audioRef.current;\r\n        if (!audio) return;\r\n\r\n        if (isPlaying) {\r\n            audio.pause();\r\n        } else {\r\n            audio.play();\r\n        }\r\n        setIsPlaying(!isPlaying);\r\n        onPlayStateChange?.(!isPlaying);\r\n    }, [isPlaying, onPlayStateChange]);\r\n\r\n    const handleVolumeChange = useCallback((e: React.ChangeEvent<HTMLInputElement>) => {\r\n        const newVolume = parseFloat(e.target.value);\r\n        setVolume(newVolume);\r\n        if (audioRef.current) {\r\n            audioRef.current.volume = newVolume;\r\n        }\r\n        if (newVolume === 0) {\r\n            setIsMuted(true);\r\n        } else {\r\n            setIsMuted(false);\r\n        }\r\n    }, []);\r\n\r\n    const toggleMute = useCallback(() => {\r\n        if (audioRef.current) {\r\n            if (isMuted) {\r\n                audioRef.current.volume = volume || 1;\r\n                setIsMuted(false);\r\n            } else {\r\n                audioRef.current.volume = 0;\r\n                setIsMuted(true);\r\n            }\r\n        }\r\n    }, [isMuted, volume]);\r\n\r\n    const handleSeek = useCallback((e: React.ChangeEvent<HTMLInputElement>) => {\r\n        const time = parseFloat(e.target.value);\r\n        setCurrentTime(time);\r\n        if (audioRef.current) {\r\n            audioRef.current.currentTime = time;\r\n        }\r\n    }, []);\r\n\r\n    const handleWaveformSeek = useCallback((time: number) => {\r\n        setCurrentTime(time);\r\n        if (audioRef.current) {\r\n            audioRef.current.currentTime = time;\r\n        }\r\n    }, []);\r\n\r\n    const handleDownload = useCallback(() => {\r\n        if (!stem.blob) return;\r\n\r\n        const url = URL.createObjectURL(stem.blob);\r\n        const a = document.createElement('a');\r\n        a.href = url;\r\n        a.download = `${stem.name}.wav`;\r\n        document.body.appendChild(a);\r\n        a.click();\r\n        document.body.removeChild(a);\r\n        URL.revokeObjectURL(url);\r\n    }, [stem]);\r\n\r\n    const progress = duration > 0 ? (currentTime / duration) * 100 : 0;\r\n\r\n    return (\r\n        <div className=\"brutalist-card p-6 bg-[#1C1D18] border border-[#45362C] transition-all duration-300 hover:translate-y-[-4px] hover:shadow-[8px_8px_0px_#45362C]\">\r\n            <audio ref={audioRef} src={stem.url} preload=\"metadata\" />\r\n\r\n            {/* Header */}\r\n            <div className=\"flex items-center justify-between mb-6\">\r\n                <div className=\"flex items-center gap-4\">\r\n                    <div\r\n                        className=\"w-12 h-12 flex items-center justify-center border-2 border-[#161711]\"\r\n                        style={{\r\n                            backgroundColor: config.color,\r\n                            boxShadow: `4px 4px 0px #F2E8DC`\r\n                        }}\r\n                    >\r\n                        <div className=\"w-8 h-8 bg-[#161711]\"></div>\r\n                    </div>\r\n                    <div>\r\n                        <h3 className=\"font-bold text-xl text-white font-outfit uppercase tracking-tighter\">{config.label}</h3>\r\n                        <p className=\"text-xs text-zinc-500 font-mono tracking-wider\">\r\n                            {formatDuration(currentTime)} / {formatDuration(duration || 0)}\r\n                        </p>\r\n                    </div>\r\n                </div>\r\n\r\n                <button\r\n                    onClick={handleDownload}\r\n                    className=\"p-3 bg-zinc-800 hover:bg-white hover:text-black transition-colors border border-black\"\r\n                    title={`Download ${config.label}`}\r\n                >\r\n                    <Download className=\"w-5 h-5\" />\r\n                </button>\r\n            </div>\r\n\r\n            {/* Waveform Visualization */}\r\n            <div className=\"mb-6 relative\">\r\n                {stem.url ? (\r\n                    <WaveformVisualizer\r\n                        audioUrl={stem.url}\r\n                        color={config.color}\r\n                        height={64}\r\n                        currentTime={currentTime}\r\n                        onSeek={handleWaveformSeek}\r\n                    />\r\n                ) : (\r\n                    <div className=\"relative h-16 bg-black border border-zinc-800\">\r\n                        <div\r\n                            className=\"absolute left-0 top-0 h-full transition-all duration-100 ease-linear\"\r\n                            style={{\r\n                                width: `${progress}%`,\r\n                                backgroundColor: `white`,\r\n                                opacity: 0.1\r\n                            }}\r\n                        />\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            {/* Controls */}\r\n            <div className=\"flex items-center justify-between gap-4\">\r\n                {/* Play/Pause */}\r\n                <button\r\n                    onClick={togglePlay}\r\n                    className=\"w-14 h-14 flex items-center justify-center transition-all bg-black border border-zinc-700 hover:bg-white hover:text-black hover:border-white\"\r\n                    style={{\r\n                        boxShadow: isPlaying ? `0 0 0 2px ${config.color}` : 'none'\r\n                    }}\r\n                    data-testid={`play-button-${stem.name}`}\r\n                >\r\n                    {isPlaying ? (\r\n                        <Pause className=\"w-6 h-6 fill-current\" />\r\n                    ) : (\r\n                        <Play className=\"w-6 h-6 fill-current ml-1\" />\r\n                    )}\r\n                </button>\r\n\r\n                {/* Volume */}\r\n                <div className=\"flex items-center gap-3 flex-1 bg-black p-3 border border-zinc-800\">\r\n                    <button\r\n                        onClick={toggleMute}\r\n                        className=\"p-1.5 hover:text-white text-zinc-500 transition-colors\"\r\n                    >\r\n                        {isMuted || volume === 0 ? (\r\n                            <VolumeX className=\"w-5 h-5\" />\r\n                        ) : (\r\n                            <Volume2 className=\"w-5 h-5\" />\r\n                        )}\r\n                    </button>\r\n                    <input\r\n                        type=\"range\"\r\n                        min={0}\r\n                        max={1}\r\n                        step={0.01}\r\n                        value={isMuted ? 0 : volume}\r\n                        onChange={handleVolumeChange}\r\n                        className=\"w-full h-2 bg-zinc-800 appearance-none cursor-pointer accent-white\"\r\n                        style={{\r\n                            backgroundImage: `linear-gradient(${config.color}, ${config.color})`,\r\n                            backgroundSize: `${(isMuted ? 0 : volume) * 100}% 100%`,\r\n                            backgroundRepeat: 'no-repeat'\r\n                        }}\r\n                    />\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\ninterface StemGridProps {\r\n    stems: StemResult[];\r\n}\r\n\r\nexport function StemGrid({ stems }: StemGridProps) {\r\n    const [isDownloading, setIsDownloading] = useState(false);\r\n\r\n    const handleDownloadAll = useCallback(async () => {\r\n        if (isDownloading) return;\r\n        setIsDownloading(true);\r\n\r\n        try {\r\n            const downloadPromises = stems.map((stem, index) => {\r\n                if (!stem.blob) return Promise.resolve();\r\n\r\n                return new Promise<void>((resolve) => {\r\n                    setTimeout(() => {\r\n                        const url = URL.createObjectURL(stem.blob!);\r\n                        const a = document.createElement('a');\r\n                        a.href = url;\r\n                        a.download = `${stem.name}.wav`;\r\n                        document.body.appendChild(a);\r\n                        a.click();\r\n                        document.body.removeChild(a);\r\n                        URL.revokeObjectURL(url);\r\n                        resolve();\r\n                    }, index * 500);\r\n                });\r\n            });\r\n\r\n            await Promise.all(downloadPromises);\r\n        } catch (error) {\r\n            console.error('Download failed', error);\r\n        } finally {\r\n            setTimeout(() => setIsDownloading(false), (stems.length * 500) + 1000);\r\n        }\r\n    }, [stems, isDownloading]);\r\n\r\n    return (\r\n        <div className=\"space-y-12 animate-in fade-in slide-in-from-bottom-8 duration-700\">\r\n            <div className=\"grid md:grid-cols-2 gap-8\">\r\n                {stems.map((stem) => (\r\n                    <StemPlayer key={stem.name} stem={stem} />\r\n                ))}\r\n            </div>\r\n\r\n            <div className=\"text-center pb-12\">\r\n                <button\r\n                    onClick={handleDownloadAll}\r\n                    disabled={isDownloading}\r\n                    className={`\r\n                        brutalist-button px-12 py-5 text-xl\r\n                        ${isDownloading ? 'opacity-80 cursor-wait' : ''}\r\n                    `}\r\n                    data-testid=\"download-all-btn\"\r\n                    data-downloading={isDownloading}\r\n                >\r\n                    <div className=\"flex items-center gap-3\">\r\n                        <Download className={`w-6 h-6 ${isDownloading ? 'animate-bounce' : ''}`} />\r\n                        {isDownloading ? 'Downloading Stems...' : 'DOWNLOAD ALL STEMS'}\r\n                    </div>\r\n                </button>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\Documents\\AI\\Singscape\\frontend\\src\\components\\ui\\WaveformVisualizer.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\Documents\\AI\\Singscape\\frontend\\src\\lib\\audio-utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\HP\\Documents\\AI\\Singscape\\frontend\\src\\types\\audio.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]
