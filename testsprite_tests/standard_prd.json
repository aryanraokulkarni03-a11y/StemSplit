{
  "meta": {
    "project": "Singscape (StemSplit)",
    "date": "2026-02-06",
    "prepared_by": "Generated by Antigravity AI"
  },
  "product_overview": "Singscape is a web application that uses AI-powered audio stem separation based on the Demucs model to extract vocals, drums, bass, and other instruments from user-uploaded audio files, enabling musicians and producers to practice, remix, and learn from individual stems.",
  "core_goals": [
    "Provide an intuitive and fast drag-and-drop audio upload supporting MP3 and WAV formats with validation.",
    "Deliver real-time progress tracking and status updates for audio stem separation processing.",
    "Enable seamless playback and control of separated audio stems with individual volume, seek, and download options.",
    "Support robust error handling and retry mechanisms for a smooth user experience.",
    "Ensure responsive, accessible, and performant UI built with a Brutalist design aesthetic using Next.js and React.",
    "Optimize bundle size by lazy loading heavy components to improve load times."
  ],
  "key_features": [
    "FileUpload component for drag-and-drop and browse-based file selection with file metadata display and validation.",
    "Processing workflow that manages state transitions, displays detailed progress with visual feedback, and supports retry on failure.",
    "StemPlayer components for each separated stem featuring play/pause, volume control, waveform visualization, and download capability.",
    "WaveformVisualizer component using Web Audio API with click-to-seek and playback progress indication.",
    "Results page showing all four stems in a grid layout with individual and bulk download options.",
    "API endpoints for file upload, audio separation (invoking Python Demucs process), and health checks.",
    "Fixed navigation header with responsive menu and Brutalist branding.",
    "Homepage with hero section, feature showcase, and smooth scroll navigation.",
    "Global Brutalist style system with pure black backgrounds, Spotify Red accent color, hard shadows, zero border-radius, and custom animations.",
    "Bundle optimization via Next.js dynamic imports to lazy-load large components."
  ],
  "user_flow_summary": [
    "User uploads an audio file (drag/drop or browse) on the homepage with instant validation and metadata display.",
    "User starts processing, navigating to the processing page where they see real-time progress bars, stem statuses, and estimated times.",
    "On completion, the user is redirected to the results page displaying four stem players with full controls and download options.",
    "Users can download stems individually or all at once and choose to process another file or return home.",
    "Users experience graceful error handling including immediate feedback on invalid files and ability to retry the processing flow after failures."
  ],
  "validation_criteria": [
    "File uploads accept only MP3/WAV files under 25MB; invalid files produce clear error messages.",
    "Processing page accurately reflects state transitions from pending through processing to complete with progress bars and stem statuses.",
    "Audio playback controls function correctly for all stems including play/pause, volume, waveform seek, and downloads.",
    "All UI elements follow the Brutalist design guidelines with correct colors, typography, spacing, and animations.",
    "Lazy-loading correctly defers loading heavy components until necessary, keeping initial bundle sizes below 1MB.",
    "Accessibility standards including keyboard navigation, screen reader support, and color contrast are met.",
    "API endpoints handle file uploads, processing requests, health checks properly with error handling and cleanup.",
    "Critical user journeys (happy path, error recovery, multi-stem management) complete without failures.",
    "Cross-browser compatibility is verified for Chrome, Firefox, Safari, and Edge latest versions."
  ],
  "code_summary": {
    "tech_stack": [
      "TypeScript",
      "Next.js 16 (App Router)",
      "React 19",
      "Tailwind CSS v4",
      "Node.js",
      "Python (Demucs AI)",
      "Audio Web APIs"
    ],
    "features": [
      {
        "name": "FileUpload Component",
        "description": "Drag-and-drop audio file upload with validation (MP3/WAV, max 25MB). Displays file metadata (name, size, duration) and provides visual feedback with Brutalist design.",
        "files": [
          "src/components/ui/FileUpload.tsx",
          "src/types/audio.ts"
        ]
      },
      {
        "name": "Audio Processing Workflow",
        "description": "Orchestrates the stem separation process. Manages state transitions (pending → processing → complete), displays progress indicators, and handles error recovery with retry functionality.",
        "files": [
          "src/app/process/page.tsx",
          "src/lib/audio-utils.ts"
        ]
      },
      {
        "name": "StemPlayer Component",
        "description": "Individual audio player for each separated stem (vocals, drums, bass, other). Features play/pause controls, volume adjustment, seek functionality via waveform, and download capability.",
        "files": [
          "src/components/ui/StemPlayer.tsx",
          "src/types/audio.ts"
        ]
      },
      {
        "name": "WaveformVisualizer",
        "description": "Canvas-based waveform visualization using Web Audio API. Shows playback progress with color changes and supports click-to-seek interaction. Lazy-loaded for performance.",
        "files": [
          "src/components/ui/WaveformVisualizer.tsx"
        ]
      },
      {
        "name": "StemGrid Component",
        "description": "Results page layout displaying all 4 separated stems in a grid. Includes 'Download All' button with sequential download functionality and state management.",
        "files": [
          "src/components/ui/StemPlayer.tsx",
          "src/app/results/page.tsx"
        ]
      },
      {
        "name": "API - File Upload",
        "description": "Next.js API route for handling multipart/form-data file uploads. Validates file size, type, and returns file metadata. Edge runtime for fast responses.",
        "files": [
          "src/app/api/upload/route.ts"
        ]
      },
      {
        "name": "API - Audio Separation",
        "description": "Next.js API route (Node.js runtime) that spawns Python child process to execute Demucs model. Streams JSON progress updates and manages temporary file cleanup.",
        "files": [
          "src/app/api/separate/route.ts"
        ]
      },
      {
        "name": "API - Health Check",
        "description": "Service health endpoint returning JSON status of API availability and backend readiness.",
        "files": [
          "src/app/api/health/route.ts"
        ]
      },
      {
        "name": "Navigation Header",
        "description": "Fixed top navigation with Brutalist badge logo, responsive menu, and scroll-to-section links. Implements mobile hamburger menu.",
        "files": [
          "src/components/layout/index.tsx"
        ]
      },
      {
        "name": "Homepage Landing",
        "description": "Hero section with massive typography, feature showcase grid, and 'How It Works' section. Includes CTA buttons and smooth scroll navigation.",
        "files": [
          "src/app/page.tsx"
        ]
      },
      {
        "name": "Results Page",
        "description": "Post-processing page displaying success message, original filename, 4 stem players, usage tips, and action buttons (Process Another, Back to Home).",
        "files": [
          "src/app/results/page.tsx"
        ]
      },
      {
        "name": "Audio Utilities",
        "description": "Helper functions for audio processing simulation, duration formatting, and mock stem separation with configurable delay and failure rate.",
        "files": [
          "src/lib/audio-utils.ts"
        ]
      },
      {
        "name": "Type Definitions",
        "description": "TypeScript interfaces for AudioFile, StemResult, ProcessingStatus, and ModelInfo. Includes STEM_CONFIG mapping and FILE_CONSTRAINTS validation rules.",
        "files": [
          "src/types/audio.ts"
        ]
      },
      {
        "name": "Brutalist Design System",
        "description": "Global CSS defining Brutalist theme with pure black background, Spotify Red primary, hard shadows, zero border-radius, and custom animations (vinyl spin, pulse).",
        "files": [
          "src/app/globals.css"
        ]
      },
      {
        "name": "Progress Bar Component",
        "description": "Reusable progress indicator with percentage display, animated fill, and state-based styling (pending/processing/complete/error).",
        "files": [
          "src/components/ui/ProgressBar.tsx"
        ]
      },
      {
        "name": "Bundle Optimization",
        "description": "Next.js dynamic imports configuration for lazy-loading heavy components (StemPlayer, FileUpload, WaveformVisualizer) to reduce initial page load.",
        "files": [
          "src/app/page.tsx",
          "src/app/results/page.tsx",
          "src/components/ui/StemPlayer.tsx",
          "next.config.ts"
        ]
      }
    ]
  }
}
